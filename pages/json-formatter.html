<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON格式化功能 - 咪啪工具集</title>
    <!-- 引入必要的库 -->
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- 引入Inter字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- 自定义配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#6C757D',
                        success: '#28A745',
                        danger: '#DC3545',
                        warning: '#FFC107',
                        info: '#17A2B8',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .file-item-hover:hover {
                @apply bg-gray-50;
            }
            .text-highlight {
                @apply bg-yellow-200 px-0.5 rounded font-semibold;
            }
            .card {
                transition: transform 0.2s ease, box-shadow 0.2s ease;
            }
            .card:hover {
                @apply transform -translate-y-1 shadow-lg;
            }
            .btn {
                transition: all 0.2s ease;
            }
            .btn:hover {
                @apply transform -translate-y-0.5;
            }
            .btn:active {
                @apply transform translate-y-0;
            }
            .json-key {
                color: #0066cc;
                font-weight: bold;
            }
            .json-string {
                color: #009900;
            }
            .json-number {
                color: #cc6600;
            }
            .json-boolean {
                color: #cc0066;
            }
            .json-null {
                color: #999999;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <header class="bg-gradient-to-r from-primary to-blue-700 text-white shadow-lg">
        <div class="container mx-auto px-4 sm:px-6 py-4 sm:py-6 flex flex-col md:flex-row justify-between items-center">
            <a href="../index.html" class="text-2xl sm:text-3xl font-bold mb-4 md:mb-0 tracking-tight hover:text-blue-200 transition-all">
                <i class="fa fa-wrench mr-2"></i>咪啪工具集
            </a>
            <!-- 导航栏简化，只保留标题返回首页功能 -->
        </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 py-8 sm:py-12 flex-grow">
        <!-- JSON格式化功能 -->
        <section class="bg-white rounded-xl shadow-md p-4 sm:p-6 mb-8 sm:mb-12 card">
            <h2 class="text-xl sm:text-3xl font-bold mb-4 sm:mb-6 flex items-center text-gray-800">
                <i class="fa fa-code mr-3 text-primary text-2xl"></i>JSON格式化
            </h2>
            
            <!-- 文本输入方式选择 -->
            <div class="mb-6">
                <div class="flex flex-wrap gap-3 mb-4">
                    <button id="jsonTextInputTab" class="px-4 py-2 bg-primary text-white rounded-l-lg hover:bg-primary/90 transition-colors btn whitespace-nowrap">
                        <i class="fa fa-paste mr-2"></i>文本粘贴
                    </button>
                    <button id="jsonFileInputTab" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-r-lg hover:bg-gray-300 transition-colors btn whitespace-nowrap">
                        <i class="fa fa-file-o mr-2"></i>文件上传
                    </button>
                </div>
            </div>

            <!-- 文件上传方式 -->
            <div id="jsonFileInputSection" class="mb-6">
                <label class="block text-gray-700 font-medium mb-2 sm:mb-3 text-sm sm:text-lg">选择JSON文件</label>
                <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-4 mb-3">
                    <div class="flex-1">
                        <input type="file" id="jsonFileUpload" accept=".json" 
                            class="block w-full text-sm text-gray-500
                            file:mr-4 file:py-2 file:px-4
                            file:rounded-lg file:border-0
                            file:text-sm file:font-medium
                            file:bg-primary/10 file:text-primary
                            hover:file:bg-primary/20 focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary" />
                    </div>
                </div>
                <div id="jsonFilesInfo" class="hidden p-3 bg-blue-50 rounded-lg border border-blue-100 mt-3 flex items-center font-medium">
                    <i class="fa fa-info-circle text-primary mr-2"></i>
                    <span id="jsonFilesInfoText" class="text-sm sm:text-base text-gray-700"></span>
                </div>
            </div>

            <!-- 直接粘贴方式 -->
            <div id="jsonTextInputSection" class="mb-6 hidden">
                <label class="block text-gray-700 font-medium mb-2 sm:mb-3 text-sm sm:text-lg">粘贴JSON内容</label>
                <div class="mb-3 relative">
                    <!-- 行号显示区域 -->
                    <div id="jsonDirectTextLineNumbers" style="border-right-style: dashed !important;" class="absolute left-0 top-0 bottom-0 w-12 bg-gray-50 border-t-[1px] border-l-[1px] border-b-[1px] border-r-[1px] border-t-solid border-l-solid border-b-solid border-r-dashed border-gray-300 rounded-l-lg flex flex-col items-end justify-start py-3 px-2 text-gray-400 font-mono text-sm overflow-hidden pointer-events-none"></div>
                    <!-- 文本输入区域 -->
                    <div class="relative">
                        <textarea id="jsonDirectTextInput" placeholder="请在此粘贴要格式化的JSON内容..." rows="10"
                            class="w-full pl-16 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none font-mono text-sm resize-none whitespace-nowrap overflow-x-auto overflow-y-auto min-h-[300px] max-h-[500px] absolute inset-0 bg-transparent z-10"></textarea>
                        <div class="w-full pl-16 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none font-mono text-sm resize-none whitespace-nowrap overflow-x-auto overflow-y-auto min-h-[300px] max-h-[500px] pointer-events-none"></div>
                    </div>
                </div>
            </div>

            <!-- 功能按钮 -->
            <div id="jsonFunctionButtons" class="flex flex-wrap gap-3 mb-6 hidden">
                <button id="formatJsonBtn" class="px-6 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors btn whitespace-nowrap">
                    <i class="fa fa-indent mr-2"></i>格式化
                </button>
                <button id="compressJsonBtn" class="px-6 py-3 bg-success text-white rounded-lg hover:bg-success/90 transition-colors btn whitespace-nowrap">
                    <i class="fa fa-compress mr-2"></i>压缩
                </button>
                <button id="validateJsonBtn" class="px-6 py-3 bg-info text-white rounded-lg hover:bg-info/90 transition-colors btn whitespace-nowrap">
                    <i class="fa fa-check-circle mr-2"></i>验证
                </button>
                <button id="clearJsonResultBtn" class="px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors btn whitespace-nowrap">
                    <i class="fa fa-trash mr-2"></i>清空
                </button>
            </div>

            <!-- 处理选项 - 默认隐藏 -->
            <div id="preserveEscapesContainer" class="mb-6 hidden">
                <div class="flex flex-wrap items-center gap-4 p-4 bg-gray-50 rounded-lg">
                    <div class="flex items-center gap-2">
                        <input type="checkbox" id="preserveEscapes" checked
                            class="w-4 h-4 text-primary border-gray-300 rounded focus:ring-primary" />
                        <label for="preserveEscapes" class="text-sm sm:text-base text-gray-700 font-medium">保留转义字符</label>
                    </div>
                </div>
            </div>

            <!-- 验证信息区域 -->
            <div id="jsonValidationInfo" class="hidden p-3 rounded-lg border mb-6 flex items-center font-medium">
                <i id="validationIcon" class="mr-2"></i>
                <span id="validationInfoText" class="text-sm sm:text-base"></span>
            </div>
            
            <!-- 处理结果 -->
            <div id="jsonResults" class="mb-6 hidden">
                <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-3">
                    <h3 class="font-medium text-gray-700 text-lg">处理结果</h3>
                    <div class="flex gap-3">
                        <button id="copyJsonResultBtn" class="px-4 py-2 bg-info text-white text-sm rounded-lg hover:bg-info/90 transition-colors btn flex items-center justify-center whitespace-nowrap">
                            <i class="fa fa-copy mr-2"></i>复制
                        </button>
                        <button id="downloadJsonResultBtn" class="px-4 py-2 bg-success text-white text-sm rounded-lg hover:bg-success/90 transition-colors btn flex items-center justify-center whitespace-nowrap">
                            <i class="fa fa-download mr-2"></i>下载
                        </button>
                    </div>
                </div>
                <div class="relative">
                    <!-- 结果行号显示区域 -->
                    <div id="jsonResultLineNumbers" style="border-right-style: dashed !important;" class="absolute left-0 top-0 bottom-0 w-12 bg-gray-50 border-t-[1px] border-l-[1px] border-b-[1px] border-r-[1px] border-t-solid border-l-solid border-b-solid border-r-dashed border-gray-300 rounded-l-lg flex flex-col items-end justify-start py-3 px-2 text-gray-400 font-mono text-sm overflow-hidden pointer-events-none"></div>
                    <!-- 结果内容区域 -->
                    <div id="jsonResultContent" class="max-h-[500px] overflow-x-auto overflow-y-auto border border-gray-300 rounded-lg divide-y divide-gray-100 bg-gray-50 pl-16 pr-4 py-3 font-mono text-sm whitespace-pre">
                        <!-- 处理结果将动态生成 -->
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gradient-to-r from-gray-800 to-gray-900 text-white py-6 sm:py-8">
        <div class="container mx-auto px-4 sm:px-6 text-center">
            <p class="text-sm sm:text-lg font-medium">Log分析工具 - 专注于高效的日志文件处理和搜索</p>
            <p class="mt-3 text-xs sm:text-base text-gray-300">使用 <i class="fa fa-heart text-danger"></i> 构建</p>
        </div>
    </footer>

    <!-- 导航栏优化脚本 -->
    <script>
        // 优化导航栏点击体验，避免不必要的页面刷新
        document.addEventListener('DOMContentLoaded', function() {
            const logoLink = document.querySelector('header a[href="../index.html"]');
            if (logoLink) {
                logoLink.addEventListener('click', function(e) {
                    // 获取当前页面的路径
                    const currentPath = window.location.pathname;
                    
                    // 定义首页路径
                    const homePaths = ['/', '/index.html'];
                    
                    // 如果当前已经在首页，阻止默认跳转，避免闪烁
                    if (homePaths.includes(currentPath)) {
                        e.preventDefault();
                    }
                });
            }
        });
    </script>
    <!-- 引入JavaScript模块 -->
    <script src="../js/json-formatter.js"></script>
</body>
</html>